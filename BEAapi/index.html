<!-- GDP of states using BEA api -->
<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="stylesheet" href="stylesheet.css">
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
</head>
<body>
  <h1>GDP of States, BEA API 2015, in Millions of Dollars</h1>
  <div id="regions_div" style="width: 900px; height: 500px;">
  </div>
  <script>
    let jsonString;
    function reqListener () {
      jsonString = this.responseText;
    }

    var oReq = new XMLHttpRequest();
    oReq.addEventListener("load", reqListener);
    oReq.open("GET", "https://www.bea.gov/api/data/?UserID=7EA6F71C-62A2-4221-A60B-7389FDD9C4C5&method=GetData&datasetname=RegionalProduct&Component=GDP_sAN&IndustryId=1&Year=2015&GeoFips=STATE&ResultFormat=json", false);
    oReq.send();

    let jsonData = JSON.parse(jsonString);

    let dataArray = [['State', 'GDP']];

    console.log(jsonData.BEAAPI.Results.Data.length)
    for(let i = 1; i < 52; i++) {
        dataArray.push([jsonData.BEAAPI.Results.Data[i].GeoName,Number(jsonData.BEAAPI.Results.Data[i].DataValue)])
    }

    google.charts.load('current', {
      'packages':['geochart'],
      'mapsApiKey': 'AIzaSyB8UyJ3-N7OIrq3siNP1YNI7EMK4T5t5HQ'
    });
    google.charts.setOnLoadCallback(drawRegionsMap);

    function drawRegionsMap() {
      let data = google.visualization.arrayToDataTable(dataArray);

      let options = {
        resolution:"provinces",
        region:"US"
      };

      let chart = new google.visualization.GeoChart(document.getElementById('regions_div'));

      chart.draw(data, options);
    }
  </script>
</body>
</html>